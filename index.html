<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>mdvim - Markdown Editor with Vim</title>
  <link rel="stylesheet" href="/src/styles/main.css">
</head>
<body>
  <div id="app">
    <header id="toolbar">
      <div class="toolbar-left">
        <span id="file-name">Untitled</span>
        <span id="file-status"></span>
      </div>
      <div class="toolbar-center">
        <button data-view="editor">Editor</button>
        <button data-view="split" class="active">Split</button>
        <button data-view="preview">Preview</button>
      </div>
      <div class="toolbar-right">
        <!-- Font size controls -->
        <div class="font-size-controls">
          <button id="btn-font-smaller" title="Smaller font">A-</button>
          <span id="font-size-display">100%</span>
          <button id="btn-font-larger" title="Larger font">A+</button>
        </div>
        
        <!-- Vim toggle -->
        <button id="btn-vim-toggle" class="active" title="Toggle Vim mode (Ctrl+`)">VIM</button>
        
        <!-- Theme selector -->
        <select id="theme-selector" title="Select theme">
          <option value="dark">Dark</option>
          <option value="light">Light</option>
          <option value="monokai">Monokai</option>
          <option value="solarized-dark">Solarized Dark</option>
          <option value="solarized-light">Solarized Light</option>
          <option value="nord">Nord</option>
          <option value="dracula">Dracula</option>
          <option value="github-dark">GitHub Dark</option>
          <option value="github-light">GitHub Light</option>
        </select>
      </div>
    </header>

    <main id="main-content">
      <div id="toc-pane" class="pane">
        <div id="toc-header">
          <span>Table of Contents</span>
          <button id="btn-toc-close" title="Close TOC">&times;</button>
        </div>
        <div id="toc-content"></div>
        <div id="toc-resizer"></div>
      </div>
      <div id="editor-pane" class="pane">
        <div id="editor-toolbar">
          <button id="btn-toc-toggle" title="Table of Contents (ÁõÆÊ¨°)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="12" x2="15" y2="12"></line>
              <line x1="3" y1="18" x2="18" y2="18"></line>
            </svg>
          </button>
          <button id="btn-insert-image" title="Insert Image (ÁîªÂÉèÊåøÂÖ•)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
          </button>
          <span class="toolbar-separator"></span>
          <span id="editor-info"></span>
        </div>
        <div id="editor-container"></div>
        <div id="vim-statusbar"></div>
      </div>
      <div id="preview-pane" class="pane">
        <div id="preview-toolbar">
          <button id="btn-fold-all" title="Fold all">‚ñº Fold</button>
          <button id="btn-unfold-all" title="Unfold all">‚ñ∂ Unfold</button>
        </div>
        <div id="preview"></div>
      </div>
    </main>

    <footer id="statusbar">
      <span id="cursor-pos">1:1</span>
      <span id="stats-info"></span>
    </footer>

    <!-- Help Modal -->
    <div id="help-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Keyboard Shortcuts</h2>
          <button id="help-close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <div class="help-section">
            <h3>File Operations</h3>
            <table>
              <tr><td><kbd>Ctrl+N</kbd></td><td>New file</td></tr>
              <tr><td><kbd>Ctrl+O</kbd></td><td>Open file</td></tr>
              <tr><td><kbd>Ctrl+S</kbd></td><td>Save file</td></tr>
              <tr><td><kbd>Ctrl+Shift+S</kbd></td><td>Save as</td></tr>
              <tr><td><kbd>Ctrl+`</kbd></td><td>Toggle VIM mode</td></tr>
            </table>
          </div>
          <div class="help-section">
            <h3>Vim Commands</h3>
            <table>
              <tr><td><kbd>:w</kbd></td><td>Save file</td></tr>
              <tr><td><kbd>:w filename</kbd></td><td>Save as filename</td></tr>
              <tr><td><kbd>:q</kbd></td><td>Quit</td></tr>
              <tr><td><kbd>:q!</kbd></td><td>Quit without saving</td></tr>
              <tr><td><kbd>:wq</kbd></td><td>Save and quit</td></tr>
              <tr><td><kbd>:e filename</kbd></td><td>Open file</td></tr>
              <tr><td><kbd>:e URL</kbd></td><td>Fetch markdown from URL</td></tr>
              <tr><td><kbd>:fetch</kbd> / <kbd>:url</kbd></td><td>Fetch markdown (prompt for URL)</td></tr>
              <tr><td><kbd>:new</kbd></td><td>New file</td></tr>
              <tr><td><kbd>:pwd</kbd></td><td>Show current directory</td></tr>
              <tr><td><kbd>:cd path</kbd></td><td>Change current directory</td></tr>
              <tr><td><kbd>:help</kbd></td><td>Show this help</td></tr>
              <tr><td><kbd>:toc</kbd></td><td>Toggle Table of Contents</td></tr>
              <tr><td><kbd>:export</kbd></td><td>Export to HTML</td></tr>
              <tr><td><kbd>:pdf</kbd></td><td>Export to PDF</td></tr>
              <tr><td><kbd>:image</kbd></td><td>Insert image from file</td></tr>
            </table>
          </div>
          <div class="help-section">
            <h3>Image Insert</h3>
            <table>
              <tr><td><kbd>Ctrl+V</kbd></td><td>Paste image from clipboard</td></tr>
              <tr><td><kbd>Drag&Drop</kbd></td><td>Drop image file onto editor</td></tr>
              <tr><td><kbd>:image</kbd></td><td>Select image file</td></tr>
              <tr><td><kbd>üñºÔ∏è button</kbd></td><td>Select image file</td></tr>
            </table>
          </div>
          <div class="help-section">
            <h3>Settings Commands</h3>
            <table>
              <tr><td><kbd>:set wrap</kbd></td><td>Enable word wrap</td></tr>
              <tr><td><kbd>:set nowrap</kbd></td><td>Disable word wrap</td></tr>
              <tr><td><kbd>:set tabsize=N</kbd></td><td>Set tab size</td></tr>
              <tr><td><kbd>:set fontsize=N</kbd></td><td>Set font size %</td></tr>
              <tr><td><kbd>:set number</kbd></td><td>Show line numbers</td></tr>
              <tr><td><kbd>:set nonumber</kbd></td><td>Hide line numbers</td></tr>
              <tr><td><kbd>:set minimap</kbd></td><td>Show minimap</td></tr>
              <tr><td><kbd>:set autosave</kbd></td><td>Enable auto-save</td></tr>
              <tr><td><kbd>:set noautosave</kbd></td><td>Disable auto-save</td></tr>
              <tr><td><kbd>:theme dark</kbd></td><td>Dark theme</td></tr>
              <tr><td><kbd>:theme light</kbd></td><td>Light theme</td></tr>
            </table>
          </div>
          <div class="help-section">
            <h3>Vim Modes</h3>
            <table>
              <tr><td><kbd>i</kbd></td><td>Insert mode</td></tr>
              <tr><td><kbd>v</kbd></td><td>Visual mode</td></tr>
              <tr><td><kbd>V</kbd></td><td>Visual line mode</td></tr>
              <tr><td><kbd>Esc</kbd></td><td>Normal mode</td></tr>
            </table>
          </div>
          <div class="help-section">
            <h3>Markdown Extensions</h3>
            <table>
              <tr><td><kbd>- [x]</kbd></td><td>Checkbox (checked)</td></tr>
              <tr><td><kbd>- [ ]</kbd></td><td>Checkbox (unchecked)</td></tr>
              <tr><td><kbd>:::note info</kbd></td><td>Info note (Qiita)</td></tr>
              <tr><td><kbd>:::note warn</kbd></td><td>Warning note (Qiita)</td></tr>
              <tr><td><kbd>:::note alert</kbd></td><td>Alert note (Qiita)</td></tr>
              <tr><td><kbd>&gt; [!NOTE]</kbd></td><td>Note (GitHub)</td></tr>
              <tr><td><kbd>&gt; [!WARNING]</kbd></td><td>Warning (GitHub)</td></tr>
              <tr><td><kbd>ÔΩúÊº¢Â≠ó„Ää„Åã„Çì„Åò„Äã</kbd></td><td>Ruby (furigana)</td></tr>
              <tr><td><kbd>[^1]</kbd></td><td>Footnote reference</td></tr>
              <tr><td><kbd>[^1]: text</kbd></td><td>Footnote definition</td></tr>
              <tr><td><kbd>$E=mc^2$</kbd></td><td>Inline math (KaTeX)</td></tr>
              <tr><td><kbd>$$...$$</kbd></td><td>Block math (KaTeX)</td></tr>
            </table>
          </div>
          <div class="help-section">
            <h3>Drag &amp; Drop</h3>
            <table>
              <tr><td>Image files</td><td>Insert as embedded image</td></tr>
              <tr><td>.md / .txt files</td><td>Open file</td></tr>
              <tr><td>.mdvim files</td><td>Open with images</td></tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="/src/main.ts"></script>
</body>
</html>
